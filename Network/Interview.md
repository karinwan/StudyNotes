# Network Interview

### OSI 七层模型 和 TCP/IP 四层模型: 

OSI`Open Systems Interconnection`七层模型：

1. _应用层_`Application Layer`：用户`user`与应用`network services`之间的接口`Interfac`（如**HTTP、FTP、SMTP**）。
1. _表示层_`Presentation Layer`：数据格式转换、加密、压缩。
1. _会话层_`Session Layer`：建立、管理、终止会话。
1. 传输层`Transport Layer`：端到端的连接（如**TCP、UDP**）。
1. 网络层`Network Layer`：数据的路由`Routing`（如**IP协议**）。
1. _数据链路层_`Data Link Layer`：数据帧`frame`的传输、错误检测与纠正。
1. _物理层_`Physical Layer`：负责传输原始比特流`raw bits`（如电缆`cable`、光纤`fiber`）。

TCP/IP四层模型：

1. 应用层（对应OSI的应用、表示、会话层）
1. 传输层`Transport Layer `（对应OSI的传输层）
1. 网络层`Internet Layer`（对应OSI的网络层）
1. 网络接口层`Network Access Layer`（对应OSI的物理层和数据链路层）

<img width="360" alt="Screenshot 2025-04-15 at 3 00 56 AM" src="https://github.com/user-attachments/assets/11424a1b-3e99-4149-ac6b-ade748a3ffd7" />


### 什么是路由和交换？

路由器`Router`： 工作在**网络层**，根据**IP地址**转发数据包，负责**不同子网或网络**`LAN/WAN`间的通信。

交换机`Switch`： 工作在**数据链路层**，根据**MAC地址**转发**数据帧**，通常用于**局域网内部**的通信。
  - MAC地址`Media Access Control Address`是指网卡在生产时被硬编码的、**全球唯一**的硬件地址，用于在局域网`LAN`中标识设备的身份。

### 子网掩码`Subnet Mask`的作用是什么？

- 是一个用来区分 IP 地址中哪一部分是网络地址`network ID`，哪一部分是主机地址`host ID`的值。

- 配合 IP 地址使用，用于判断两个 IP 是否在同一个子网中。只有在同一子网内才能直接通信。否则需要通过路由器。

- 一个 IP 地址实际上包含两个部分：
  - 网络号：你所在的网络范围
  - 主机号：你在网络中的设备编号

  子网掩码决定了前面多少位是网络号，后面多少位是主机号。

  >IP 地址192.168.1.10，转换成二进制：11000000.10101000.00000001.00001010。
  >
  >假设子网掩码是：255.255.255.0，即 11111111.11111111.11111111.00000000，其中`1`表示网络部分`0`表示主机部分。
  >
  >所以网络地址为：192.168.1.0，主机范围为： 192.168.1.1 到 192.168.1.254。
  >
  >常用子网掩码包括：`255.0.0.0`， `255.255.0.0`， `255.255.255.0`
  

### 什么是 DNS？如何工作？

- DNS`Domain Name System` 将域名解析为 IP 地址。
- 用户输入网址 → 发送请求至 DNS → 返回对应 IP。


### 什么是 IP 地址？IPv4 和 IPv6 区别？

- IPv4： **32** 位，如 `192.168.1.1`，约 43 亿个地址。
- IPv6： **128** 位，如 `2001:0db8:...`，几乎无限。


### TCP 三次握手
建立一个**可靠连接**前，客户端与服务器之间需要进行**三次通信**来确认彼此状态和准备情况：

1. 客户端发送 `SYN(seq=x)`
   - 客户端发送一个SYN`synchronize`报文段，并携带一个初始序列号`x`，请求建立连接。
2. 服务器回应 `SYN + ACK(seq=y, ack=x+1)`
    - 自己的序列号`y`
    - 对客户端序列号的确认号 `x + 1`
3. 客户端回应 `ACK(ack=y+1)`
   - 客户端收到服务器回应后，发送一个ACK报文段`y + 1`，表示确认服务器的序列号。


#### 为什么需要三次握手？
- 一次握手：客户端发了连接请求，但不知道服务器是否收到。服务器可能已经挂了，网络断了，或者 SYN 丢了，所以不能只靠一次通信建立可靠连接。
- 两次握手：服务器回复了，但客户端可能没有收到（比如断网），此时服务器以为连接建立了，但客户端并不知道，就不会再通信了。于是，服务器一直保持**半连接**`half-open connections`状态，占用资源（称为：SYN Flood 攻击漏洞）。
- 三次握手：客户端告诉服务器：“收到了回应，也准备好了”。服务器这时才真正把连接标记为`ESTABLISHED`状态。
  - 确保了双向通信是可靠的。
  - 防止**半连接占用资源**问题。


### TCP 和 UDP

| 特性     | TCP 传输控制协议`Transmission Control Protocol` | UDP 用户数据报协议`User Datagram Protocol` |
|----------|---------------------------|--------------------------|
| 连接     | 面向连接：必须先通过“三次握手”建立连接 | 无连接：不需要握手，直接发数据 |
| 可靠性   | 可靠、有序、可重传：丢包会重传，数据顺序会被维护 | 不可靠、无序、不重传：丢包不管，数据顺序不保证 |
| 速度 | 较慢，控制多（流量控制：避免发送方发得太快；拥塞控制：根据网络情况调整速率） | 速度快，开销小 | 
| 数据完整性 | 保证（校验 + 重传），适合传输重要数据 | 不保证，适合 “速度 > 准确” 的实时传输 |
| 应用场景     | 文件传输`FTP`、网页浏览`HTTP/HTTPS`、邮件`SMTP`、数据库连接、登录 | 视频/语音通话、实时直播、游戏、广播 |


#### TCP滑动窗口机制 `Sliding Window`

- TCP 实现**流量控制**的核心机制。
- 允许**未被确认**的数据连续发送，只要窗口大小（单位：字节）允许，减少等待时间。
- 允许动态调整窗口大小，防止拥塞。由接收方通过`ACK`告诉发送方。
- 与**拥塞控制**配合使用：除了接收方的窗口 `rwnd（receiver window）`，还有一个 `cwnd（congestion window`）由**发送方**根据**网络拥塞状态**动态调整。实际窗口大小为`min(rwnd, cwnd)`。









